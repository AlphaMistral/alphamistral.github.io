<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="null">
    <meta name="keyword" content="null">
    <meta name="theme-color" content="#600090">
    <meta name="msapplication-navbutton-color" content="#600090">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#600090">
    <link rel="shortcut icon" href="https://cdn4.iconfinder.com/data/icons/ionicons/512/icon-person-128.png">
    <link rel="alternate" type="application/atom+xml" title="Weymire" href="/atom.xml">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.css">
    <title>
        
        é•œå¤´ç‚«å…‰ä¸å…‰æ™•ï½œWeymire&#39;s Blog
        
    </title>

    <link rel="canonical" href="http://www.weymire.com/2016/11/26/essay4/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/blog-style.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<style>

    header.intro-header {
        background-image: url('../image/tags.jpg')
    }
</style>
<!-- hack iOS CSS :active style -->
<body ontouchstart="" class="animated fadeIn">
<!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top " id="nav-top" data-ispost = "true" data-istags="false
" data-ishome = "false" >
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand animated pulse" href="/">
                <span class="brand-logo">
                    Weymire
                </span>
                's Blog
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <!-- /.navbar-collapse -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
					
                    
                        
							
                        <li>
                            <a href="/404/">å•Šå“¦! 404 Not Found!</a>
                        </li>
							
						
                    
                        
							
                        <li>
                            <a href="/Portfolio/">Portfolio</a>
                        </li>
							
						
                    
                        
							
                        <li>
                            <a href="/tags/">Featured Tags</a>
                        </li>
							
						
                    
					
					
                </ul>
            </div>
        </div>
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
//    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>

<!-- Main Content -->

<!--only post-->


<img class="wechat-title-img"
     src="http://ol56no7p4.bkt.clouddn.com/essay4.jpg">


<style>
    
    header.intro-header {
        background-image: url('http://ol56no7p4.bkt.clouddn.com/essay4.jpg?imageView2/1/w/1400/h/400/interlace/1/q/90')
    }

    
</style>

<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                <div class="post-heading">
                    <h1>é•œå¤´ç‚«å…‰ä¸å…‰æ™•</h1>
                    
                    <h2 class="subheading">å¹¶ä¸å›°éš¾, ä½†æ˜¯æ­¥éª¤ç¹å¤šçš„åæœŸç‰¹æ•ˆ</h2>
                    
                    <span class="meta">
                         ä½œè€… Jingping Yu
                        <span>
                          æ—¥æœŸ 2016-11-26
                         </span>
                    </span>
                    <div class="tags text-center">
                        
                        <a class="tag" href="/tags/#Unity"
                           title="Unity">Unity</a>
                        
                        <a class="tag" href="/tags/#Computer Graphics"
                           title="Computer Graphics">Computer Graphics</a>
                        
                        <a class="tag" href="/tags/#Shader"
                           title="Shader">Shader</a>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="post-title-haojen">
        <span>
            é•œå¤´ç‚«å…‰ä¸å…‰æ™•
        </span>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Container -->
            <div class="col-lg-8 col-lg-offset-1 col-sm-9 post-container">
                <script src="/assets/js/DPlayer.min.js"> </script><p>æœ¬æ–‡åŒæ—¶ä¹Ÿå‘è¡¨åœ¨æˆ‘çš„<a href="https://zhuanlan.zhihu.com/p/23950559?refer=MeowShader" target="_blank" rel="external">çŸ¥ä¹ä¸“æ </a>ä¸ŠğŸ˜„. ä¸è¿‡å½“æ—¶å†™ä½œçš„é£æ ¼å®åœ¨ä¸é€‚åˆæŠ€æœ¯æ–‡, å› æ­¤åœ¨ä¸ªäººåšå®¢ä¸­çš„è¿™ç¯‡æ–‡ç« ç»è¿‡äº†ä¸€äº›ä¿®æ”¹.</p>
<blockquote>
<p>ä½œè€…ï¼šéŸ³é€Ÿé”®ç›˜çŒ«</p>
<p>é“¾æ¥ï¼šhttps://zhuanlan.zhihu.com/p/23971284?refer=MeowShader</p>
<p>æ¥æºï¼šçŸ¥ä¹</p>
<p>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
</blockquote>
<h2>é•œå¤´å…‰æ™•å’Œç‚«å…‰æ˜¯ä»€ä¹ˆ?</h2>
<p>æˆ‘ä»¬éƒ½çŸ¥é“, å…‰åœ¨ä¼ æ’­çš„è¿‡ç¨‹ä¸­ç»è¿‡ä¸¤ç§æŠ˜å°„ç‡ä¸åŒçš„ä»‹è´¨äº¤ç•Œé¢æ—¶, ä¼šå‘ç”ŸæŠ˜å°„å’Œåå°„ç°è±¡. å½“æŠ˜å°„å’Œåå°„è¾¾æˆæŸç§è§’åº¦, å°¤å…¶æ˜¯å…‰æ¯”æ¯”è¾ƒå¤§æ—¶, åå°„å…‰å’ŒæŠ˜å°„å…‰å¯ä»¥äº¤æ±‡å½¢æˆç‚«å…‰. åœ¨å¤šæ•°æƒ…å†µä¸‹, è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„ç°è±¡, å› ä¸ºè¿™å¯¼è‡´è¢«è§‚å¯Ÿç‰©ä½“çš„è¡¨ç°å½¢å¼å¤±çœŸ. ç°åœ¨å¤§å¤šæ•°é•œå¤´çš„é•œç‰‡ä¸Šéƒ½ä¼šæœ‰å„ç§å„æ ·çš„é•€è†œ, ä¸ºçš„å°±æ˜¯å‡å°‘ç‚«å…‰çš„å‡ºç°.</p>
<p><img src="/image/essay4/1.jpg" alt=""></p>
<p>å¦‚ä¸Šå›¾, è¿™å°±æ˜¯ä¸€ä¸ªæ ‡å‡†çš„é•œå¤´ç‚«å…‰çš„ç»“æœ. è¿™ç§ç»“æœå½“ç„¶ä¸ä¼šæ˜¯æˆ‘ä»¬æƒ³è¦çš„.</p>
<p><img src="/image/essay4/2.jpg" alt=""></p>
<p>å½“ç„¶äº†, å¦‚æœä½¿ç”¨å¾—å½“, é•œå¤´å…‰æ™•ä¹Ÿå¯ä»¥åƒè¿™æ · ...</p>
<p>é‚£ä¹ˆ, æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦åšä¸€ä¸ªé•œå¤´ç‚«å…‰çš„ç‰¹æ•ˆå‘¢?</p>
<p>ç¬¬ä¸€, è™½ç„¶é•œå¤´ç‚«å…‰æ˜¯äººé€ æ•ˆæœ, ä½†æ˜¯å®ƒèƒ½å¤Ÿå¢åŠ ä¸€å¼ å›¾ç‰‡çš„<strong>åŠ¨æ€èŒƒå›´</strong>, ä½¿å…¶æ›´åŠ ç›´è§‚å’Œæ¸…æ™°åœ°é˜è¿°æ˜äº®åº¦.</p>
<p>ç¬¬äºŒ, é•œå¤´ç‚«å…‰ç»™äººä¸€ç§æ„å¢ƒåŒ–çš„æ„Ÿè§‰, ä½¿ç”¨å¾—å½“å¯ä»¥è®©äººæ›´åŠ <strong>èº«ä¸´å…¶å¢ƒ</strong>.</p>
<p>ç¬¬ä¸‰, é•œå¤´ç‚«å…‰çœ‹èµ·æ¥çœŸçš„å¾ˆ<strong>é…·</strong> ...</p>
<h2>å®ç°çš„åŸºæœ¬æ€è·¯</h2>
<p>æ ¹æ®ä¸€ä¸ªRenderTexture(ä¸€èˆ¬ç®€ç§°ä¸ºRT, ä¹Ÿå¯ä»¥ç§°ä½œRender Target)çš„é¢œè‰²ä¿¡æ¯, é€šè¿‡åæœŸå›¾åƒç‰¹æ•ˆ(Image Effect)è®¡ç®—äº§ç”Ÿä¸€å¼ å¸¦æœ‰å…¶é•œå¤´å…‰æ™•çš„RT, ç„¶åå°†åäº§ç”Ÿçš„RTåˆå¹¶åˆ°åŸæœ¬çš„RTä¸­é€šè¿‡å±å¹•è¾“å‡º.</p>
<p>æ–‡ç« ä¸­ä»‹ç»çš„åšæ³•<strong>ä¸æ˜¯åŸºäºç‰©ç†</strong>çš„, å› æ­¤åªèƒ½è¿‘ä¼¼åœ°æ¨¡æ‹Ÿç‚«å…‰æ•ˆæœ. ä½†æ˜¯æ€§èƒ½å¼€é”€éå¸¸å»‰ä»·, å¯ä»¥åº”ç”¨åˆ°ç§»åŠ¨ç«¯ä¸Š. æ•ˆæœä¹Ÿè¿˜å¯ä»¥.</p>
<h2>ç‰¹æ•ˆçš„åŸºæœ¬æµç¨‹</h2>
<p>ç¬¬ä¸€æ­¥, æ ¹æ®ä¸€ä¸ªé˜ˆå€¼æå–å›¾åƒä¸­çš„æ‰€æœ‰æ˜äº®åº¦é«˜çš„åƒç´ , å¹¶å°†ç»“æœé€‚å½“é™é‡‡æ ·(DownSample)ä»¥æå‡æ—¶é—´æ•ˆç‡. å…³äºé™é‡‡æ ·, Unityçš„Standard Assetsä¸­çš„åæœŸç‰¹æ•ˆä¸­æœ‰é™é‡‡æ ·çš„æºä»£ç .</p>
<p>ç¬¬äºŒæ­¥, åŸºäºç¬¬ä¸€æ­¥å¾—åˆ°çš„RT, è®¡ç®—å‡ºå¯¹åº”çš„é¬¼å½±ä½ç½®.</p>
<p>ç¬¬ä¸‰æ­¥, å¯¹ç¬¬äºŒæ­¥å¾—åˆ°çš„RTè¿›è¡Œé«˜æ–¯æ¨¡ç³Š, è€Œåè¿›è¡Œæ˜Ÿå°„çº¿é‡‡æ ·å¤„ç†, å¾—åˆ°çœŸæ­£çš„é•œå¤´ç‚«å…‰.</p>
<p>ç¬¬å››æ­¥, å°†ç¬¬ä¸‰æ­¥çš„RTå’ŒåŸæœ‰ColorBufferè¿›è¡Œæ··åˆ, æŠ•å°„åˆ°å±å¹•ä¸Š.</p>
<h2>Step 1: é™é‡‡æ ·å’Œåƒç´ æå–</h2>
<p>é™é‡‡æ ·æ˜¯ä¸ºäº†ä»¥ç‰ºç‰²å›¾åƒè´¨é‡ä¸ºä»£ä»·æ¥é™ä½åç»­æ“ä½œçš„æ€§èƒ½å¼€é”€. åœ¨åé¢çš„æ“ä½œè¿‡ç¨‹ä¸­æˆ‘ä»¬æ¶‰åŠåˆ°äº†é«˜æ–¯æ¨¡ç³Š, è€Œé¡¾åæ€ä¹‰åæ­£æ—©æ™šè¦æ¨¡ç³Š, é‚£å¹²è„†è¾“å…¥ä¸€ä¸ªæœ¬æ¥å°±æœ‰ç‚¹ç³Š(æ³¨æ„, æˆ‘è¯´æ˜¯&quot;æœ‰ç‚¹&quot;), ä½†æ˜¯å°ºå¯¸å°å¾ˆå¤šçš„RTè¯¥å¤šä¹ˆåˆ’ç®—. å› æ­¤å¯ä»¥å…ˆç”¨å°†åŸå›¾é‡‡æ ·åˆ°ä¸€ä¸ªå°ºå¯¸æ›´å°çš„å›¾ç‰‡ä¸­çš„æ–¹å¼æ¥å‹ç¼©åŸå›¾. æ€è·¯æ˜¯ä½¿ç”¨ä¸€ä¸ªé•¿å®½ç­‰æ¯”ä¾‹ç¼©å°kå€çš„RT, åœ¨ç€è‰²å™¨å®ç°è¿‡ç¨‹ä¸­æ¯éš”åŸå›¾çš„kä¸ªåƒç´ ç‚¹é‡‡æ ·ä¸€æ¬¡, æ”¾åˆ°æ–°çš„é™é‡‡æ ·RTä¸­. å…·ä½“åˆ°ç¨‹åºå®ç°çš„è¯å¯ä»¥å¦‚æ­¤ç†è§£: å°†é™é‡‡æ ·RT&quot;å¼ºè¡Œ&quot;æ‹‰ä¼¸åˆ°åŸå›¾çš„å°ºå¯¸, é‚£ä¹ˆç›¸é‚»ä¸¤ä¸ªç‰‡å…ƒçš„UVåæ ‡å·®è·ä¹Ÿå°±å¢åŠ åˆ°äº†åŸæ¥çš„Kå€. å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨é™é‡‡æ ·RTç‰‡å…ƒçš„UVåæ ‡æ¥é‡‡æ ·åŸå›¾. ä¸ºäº†ä¿è¯é™é‡‡æ ·åçš„æ•ˆæœ, æˆ‘ä»¬å°†åŸå›¾å¯¹åº”éƒ¨åˆ†çš„ä¸Šä¸‹å·¦å³å››ä¸ªåƒç´ ç‚¹æ±‚å¹³å‡å€¼è¿›è¡Œè¾“å‡º. (åœ¨Unityå®˜æ–¹Shaderä¸­æ˜¯é‡‡ç”¨å¯¹åº”éƒ¨åˆ†åƒç´ ç‚¹å’Œå…¶å·¦è¾¹, å³è¾¹, å·¦ä¸‹è§’å…±å››ä¸ªåƒç´ ç‚¹æ±‚å¹³å‡å€¼, åœ¨æœ€ç»ˆçš„è§†è§‰æ•ˆæœä¸Šæ„Ÿè§‰ä¹Ÿæ²¡ä»€ä¹ˆå·®å¼‚, ä½†æ˜¯å–ä¸Šä¸‹å·¦å³ä¼¼ä¹æ›´ç¬¦åˆ&quot;å¯¹ç§°&quot;çš„å¼ºè¿«ç—‡æ€æƒ³).</p>
<p>åœ¨é™é‡‡æ ·å, æˆ‘ä»¬éœ€è¦ä»ä¸­æå–ä¸€äº›æ˜äº®åº¦è¾ƒé«˜çš„åƒç´ . å› ä¸ºæˆ‘ä»¬åªå¸Œæœ›å°†å›¾ç‰‡ä¸­ç‰¹åˆ«æ˜äº®çš„éƒ¨åˆ†è¿›è¡Œé•œå¤´å…‰æ™•åŒ–çš„å¤„ç†. å…·ä½“åšæ³•å°±å¾ˆç®€å•äº†, é™é‡‡æ ·åçš„é¢œè‰²åƒç´ RGBè¶…è¿‡é˜ˆå€¼çš„éƒ¨åˆ†æå–å‡ºæ¥.</p>
<p><figure class="highlight"><table><tr><td class="code"><pre><div class="line">struct v2f_DownSample </div><div class="line">&#123; </div><div class="line">	float4 pos : SV_POSITION; </div><div class="line">	half2 uv20 : TEXCOORD0; </div><div class="line">	half2 uv21 : TEXCOORD1; </div><div class="line">	half2 uv22 : TEXCOORD2; </div><div class="line">	half2 uv23 : TEXCOORD3; </div><div class="line">&#125;; </div><div class="line"></div><div class="line">v2f_DownSample vert_DownSample ( appdata_img v ) </div><div class="line">&#123; </div><div class="line">	v2f_DownSample o; </div><div class="line">	o.pos = mul ( UNITY_MATRIX_MVP, v.vertex ); </div><div class="line">	o.uv20 = UnityStereoScreenSpaceUVAdjust ( v.texcoord + _MainTex_TexelSize * half2 ( 0.5h, 0.5h ), _MainTex_ST ); </div><div class="line">	o.uv21 = UnityStereoScreenSpaceUVAdjust ( v.texcoord + _MainTex_TexelSize * half2 ( -0.5h, 0.5h ), _MainTex_ST ); </div><div class="line">	o.uv22 = UnityStereoScreenSpaceUVAdjust ( v.texcoord + _MainTex_TexelSize * half2 ( -0.5h, -0.5h ), _MainTex_ST ); </div><div class="line">	o.uv23 = UnityStereoScreenSpaceUVAdjust ( v.texcoord + _MainTex_TexelSize * half2 ( 0.5h, -0.5h ), _MainTex_ST ); </div><div class="line">	return o; </div><div class="line">&#125; </div><div class="line"></div><div class="line">fixed4 frag_DownSample ( v2f_DownSample i ) : COLOR </div><div class="line">&#123; </div><div class="line">	fixed4 color = tex2D ( _MainTex, i.uv20 ) + tex2D ( _MainTex, i.uv21 ) + tex2D ( _MainTex, i.uv22 ) + tex2D ( _MainTex, i.uv23 ); </div><div class="line">	return max ( 0.0, color / 4 - _Threshold ) * _Intensity; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å¯¹åº”çš„C#è„šæœ¬:</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">int rtWidth = source.width &gt;&gt; downSampleNum; </div><div class="line">int rtHright = source.height &gt;&gt; downSampleNum; </div><div class="line">RenderTexture downSampleBuffer = RenderTexture.GetTemporary(rtWidth, rtHright, 0, source.format); downSampleBuffer.filterMode = FilterMode.Bilinear;</div></pre></td></tr></table></figure></p>
<p>æˆæœå¦‚ä¸‹:</p>
<p><img src="/image/essay4/3.png" alt=""></p>
<p>(åŸå›¾)</p>
<p><img src="/image/essay4/4.png" alt=""></p>
<p>(æå–é«˜äº®é¢œè‰²)</p>
<p><img src="/image/essay4/5.png" alt=""></p>
<p>(é™é‡‡æ ·å)</p>
<h2>Step 2: è®¡ç®—é¬¼å½±</h2>
<p>é¬¼å½±æ˜¯å•¥? å¬èµ·æ¥å¥½ææ€–çš„æ ·å­, ä¸ä¼šè®©Unityå´©æºƒå§?</p>
<p>ç®€å•æ¥è¯´, æˆ‘ä»¬è¦å®ç°çš„é¬¼å½±å°±æ˜¯å°†ç¬¬ä¸€æ­¥ä¸­å¾—åˆ°çš„RTçš„æ˜äº®éƒ¨åˆ†é”™ä½é‡å¤æ¸²æŸ“å‡ æ¬¡, è¾¾åˆ°æ¨¡æ‹Ÿå¤šå±‚é•œç‰‡åå°„çš„æ•ˆæœ. åœ¨è¿™é‡Œæˆ‘ä»¬é»˜è®¤å¯¹ç§°ä¸­å¿ƒå°±æ˜¯æˆ‘ä»¬çš„åŸå›¾å›¾åƒä¸­å¿ƒ(å½“ç„¶å› æ­¤ä¹Ÿå°±åŒæ—¶æ˜¯é™é‡‡æ ·åçš„RTä¸­å¿ƒ).</p>
<p>OK, æˆ‘ä»¬å…ˆæ¥ä¸ªç®€å•çš„ç‰ˆæœ¬, åªæ¸²æŸ“ä¸€ä¸ªé¬¼å½±, å’ŒåŸæœ¬çš„åƒç´ ä½ç½®ç›¸å¯¹äºå›¾ç‰‡ä¸­å¿ƒå‘ˆä¸­å¿ƒå¯¹ç§°. å®ç°ä¸Šå¾ˆç®€å•, é‡æ–°é‡‡æ ·ä¸€æ¬¡ç„¶åå’Œæ··åˆç›¸åŠ å°±å¥½:</p>
<p><img src="/image/essay4/6.png" alt=""></p>
<p>è¿™ä¼¼ä¹æœ‰ç‚¹å¤ªæ— èŠäº†, æˆ‘ä»¬åº”è¯¥å†åŠ å‡ ä¸ªé¬¼å½±æ‰èƒ½å®ç°æ¨¡æ‹Ÿå¤šæ¬¡åå°„çš„æ•ˆæœ. ä½†æ˜¯æˆ‘ä»¬éƒ½çŸ¥é“, åœ¨çœŸæ­£çš„é•œå¤´ä¸­, è¿™ç§é¬¼å½±è¶Šè¶‹è¿‘äºåå°„ä¸­å¿ƒè¶Šå°, è¶Šé è¿‘é•œå¤´è¾¹ç¼˜åˆ™è¶Šå¤§, ç›¸å½“äºåœ¨ä¸­å¿ƒå¯¹ç§°çš„è¿‡ç¨‹ä¸­&quot;åˆå¤šäº†ä¸€å°æ®µè·ç¦»&quot;. å› æ­¤æˆ‘ä»¬åº”è¯¥å¼•å…¥ä¸€ä¸ªé¬¼å½±å‘æ•£ç‡dis, ç”¨ä»¥è¡¨ç¤ºç¬¬iå±‚é¬¼å½±ç›¸å¯¹äºi-1å±‚çš„ä½ç½®å’Œå¤§å°çš„åç¦»æƒ…å†µ.</p>
<p>å…·ä½“åˆ°å®ç°ä¸Š, æˆ‘ä»¬å¯ä»¥ä»å½“å‰åƒç´ ç‚¹å‘ç”»é¢ä¸­å¿ƒè¿ä¸€ä¸ªå‘é‡v, å¾ˆå®¹æ˜“å‘ç°$v<em>dis</em>i$å°±æ˜¯å½“å‰é¬¼å½±çš„åç¦»å‘é‡. é‡‡æ ·åç›¸åŠ , æˆ‘ä»¬å°±å¾—åˆ°äº†è¿™æ ·çš„ç»“æœ:</p>
<p><img src="/image/essay4/7.png" alt=""></p>
<p>ä»£ç å¦‚ä¸‹:</p>
<p><figure class="highlight"><table><tr><td class="code"><pre><div class="line">v2f_Simple vert_Simple ( appdata_img v ) </div><div class="line">&#123; </div><div class="line">	v2f_Simple o; o.pos = mul ( UNITY_MATRIX_MVP, v.vertex ); </div><div class="line">	o.uv = v.texcoord.xy; </div><div class="line">	return o; </div><div class="line">&#125; </div><div class="line"></div><div class="line">fixed4 frag_Ghost ( v2f_Simple i ) : COLOR </div><div class="line">&#123; </div><div class="line">	half2 newUV = half2 ( 1.0h, 1.0h ) - i.uv; </div><div class="line">	half2 ghostVector = ( half2 ( 0.5h, 0.5h ) - newUV ) * _GhostDispersal; </div><div class="line">	fixed4 finalColor = fixed4 ( 0, 0, 0, 0 ); </div><div class="line">	for (int ii = 0;ii &lt; _GhostNum;ii++) </div><div class="line">	&#123; </div><div class="line">		half2 offset = frac ( newUV + ghostVector * float ( ii ) ); </div><div class="line">		float weight = length ( half2 ( 0.5h, 0.5h ) - offset ) / length ( half2 ( 0.5h, 0.5h ) ); </div><div class="line">		weight = pow ( 1.0 - weight, 1.0 ); finalColor += tex2D ( _MainTex, offset ) * weight;</div><div class="line">	&#125; </div><div class="line">	return finalColor * tex2D ( _Gradient, length ( half2 ( 0.5h, 0.5h ) - newUV ) / length ( half2 ( 0.5h, 0.5h ) ) );</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2>Step 3: æ¨¡ç³Š</h2>
<p>é¬¼å½±è®¡ç®—å®Œäº†, æˆ‘ä»¬æŠŠå®ƒå’ŒColorBufferæ··åˆä¸‹çœ‹çœ‹æ•ˆæœå§!</p>
<p><img src="/image/essay4/8.png" alt=""></p>
<p>*èƒ½ä¸èƒ½å†ä¸ç»™åŠ›ä¸€ç‚¹ ... ? *</p>
<p>é—®é¢˜å‡ºåœ¨å“ª?</p>
<p>å¤ªå†™å®äº†! æˆ‘ä»¬è¦çš„æ˜¯å…‰æ–‘, å…‰æ™•, å’Œç‚«å…‰, ä½†æ˜¯è¿™ä¸ªç»“æœå«é•œé¢åå°„!</p>
<p>é‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥è¦åšçš„äº‹æƒ…å°±å¾ˆæ˜ç¡®äº†: è¾“å…¥ä¸€ä¸ªæ£±è§’åˆ†æ˜çš„RT, è¾“å‡ºä¸€ä¸ªæ¨¡æ¨¡ç³Šç³Šå¸¦ç€å…‰æ–‘çš„RT.</p>
<p>å¾ˆå¥½, æˆ‘çŒœä½ ä¹Ÿæƒ³åˆ°äº†<strong>é«˜æ–¯æ¨¡ç³Š(Gaussian Blur)</strong>.</p>
<p>é«˜æ–¯æ¨¡ç³Šçš„ä»£ç å°±ä¸è´´äº†, ç½‘ä¸Šæœ‰å¾ˆå¤š. æˆæœå¦‚ä¸‹:</p>
<p><img src="/image/essay4/9.png" alt=""></p>
<h2>Step 4: ä¸ColorBufferæ··åˆ</h2>
<p>æˆ‘ä»¬å°†ç¬¬ä¸‰æ­¥å¾—åˆ°çš„RTè®¾ç½®ä¸ºç€è‰²å™¨çš„æœ€ç»ˆé¬¼å½±çº¹ç†, å¹¶å•ç‹¬åœ¨ä¸€ä¸ªpassä¸­å°†åŸå›¾å’Œé¬¼å½±è¿›è¡Œæ··åˆ.</p>
<p><figure class="highlight"><table><tr><td class="code"><pre><div class="line">fixed4 frag_Flare ( v2f_Simple i ) : COLOR</div><div class="line">&#123;</div><div class="line">		return tex2D ( _MainTex, i.uv ) + tex2D ( _Flare, i.uv );</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç„¶åæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸‹é¢çš„ç»“æœ:</p>
<p><img src="/image/essay4/10.png" alt=""></p>
<p>è™½ç„¶çœ‹èµ·æ¥è¿˜æ˜¯æœ‰ç‚¹å¥‡æ€ª, ä¸è¿‡ç›¸æ¯”äºä¹‹å‰è¿˜æ˜¯æ­£å¸¸å¤ªå¤šäº†.</p>
<h2>ä½†æ˜¯, æˆ‘ä»¬ä¸å¸Œæœ›å®ƒçœ‹èµ·æ¥å¥‡æ€ª</h2>
<p><img src="/image/essay4/1.jpg" alt=""></p>
<p>è¿™ä¸ªå›¾è™½ç„¶æœ‰ç‚¹ä¸‘, ä½†æ˜¯å®ƒçš„å…‰æ™•å¾ˆæ­£å¸¸, èƒ½å¤Ÿç»™æˆ‘ä»¬ä¸€äº›æç¤º:</p>
<p>é¦–å…ˆ, è¿™ä¸ªå…‰æ™•å—ä¸€ç§&quot;æ˜Ÿå°„çº¿&quot;çš„å½±å“, ç»™äººä»¥ä¸€ç§æœ¦èƒ§, é¢¤æŠ–çš„æ„Ÿè§‰. å› æ­¤, æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¸ºæ¨¡ç³Šåçš„é¬¼å½±åŠ ä¸Šä¸€å±‚<strong>StarBurst</strong>é‡‡æ ·.</p>
<p><img src="/image/essay4/11.jpg" alt=""></p>
<p>å†è€…, é€šè¿‡è§‚å¯Ÿæˆ‘ä»¬å‘ç°, å…‰æ™•çš„è“è‰²å’Œé»„è‰²(å…¶å®æ˜¯ç»¿è‰²)çš„éƒ¨åˆ†é›†ä¸­åœ¨ä¸­å¤®, è€Œçº¢è‰²åˆ™æ‰©æ•£åˆ°äº†æ•´ä¸ªå±å¹•çš„å„ä¸ªè§’è½. è¿™æ˜¯å› ä¸ºé•œå¤´å¯¹ä¸åŒæ³¢é•¿çš„å…‰æœ‰ä¸åŒçš„æŠ˜å°„æ•ˆæœ. ä¸ºäº†å®é™…åœ°è¡¨ç°å‡ºè¿™ç§æ•ˆæœ, æˆ‘ä»¬éœ€è¦åšä¸¤ä»¶äº‹æƒ…:</p>
<p>ç¬¬ä¸€, åœ¨è®¡ç®—é¬¼å½±çš„è¿‡ç¨‹ä¸­, åº”è¯¥å…è®¸RGBå„è‡ªä»¥ä¸åŒçš„ç¼©æ”¾ç‡è¿›è¡Œé‡‡æ ·.</p>
<p>ç¬¬äºŒ, åœ¨é¬¼å½±è®¡ç®—å®Œæˆå, åŠ å…¥ä¸€ä¸ªé•œå¤´å¾„å‘é‡‡æ ·çº¹ç†, ä¸é¬¼å½±ç›¸æ··åˆ.</p>
<p><img src="/image/essay4/12.png" alt=""></p>
<p>(å¾„å‘é‡‡æ ·çº¹ç†, è¿™å¼ çº¹ç†æ„å‘³ç€é è¿‘å±å¹•ä¸­å¤®çš„é¬¼å½±æ›´åŠ åå‘çº¢è‰², è¶Šå‘å¤–è¶Šå¼€å§‹é è¿‘ç»¿è‰², è“è‰², ä¾æ¬¡å¾€å¤ç±»æ¨)</p>
<p>ä¸ºäº†åšåˆ°ç¬¬ä¸€æ­¥, æˆ‘ä»¬ä¿®æ”¹ä¸‹ç¬¬äºŒæ­¥ä¸­é¬¼å½±çš„é‡‡æ ·å³å¯.</p>
<p><figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line">finalColor += GetDistortedColor ( offset, normalize ( ghostVector ) ) * weight;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function">fixed4 <span class="title">GetDistortedColor</span> <span class="params">( half2 uv, half2 dir)</span></span></div><div class="line">    &#123;</div><div class="line">    	<span class="keyword">return</span> fixed4 (</div><div class="line">    		tex2D ( _MainTex, uv + dir * _ColorDistortion.r ).r,</div><div class="line">    		tex2D ( _MainTex, uv + dir * _ColorDistortion.g ).g,</div><div class="line">    		tex2D ( _MainTex, uv + dir * _ColorDistortion.b ).b,</div><div class="line">    		<span class="number">1</span></div><div class="line">    	);</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>æœ€ç»ˆæˆæœå¦‚ä¸‹:</p>
<p><img src="/image/essay4/13.png" alt=""></p>

                <hr>
                
                <!-- å¤šè¯´ Share start -->
                <div class="ds-share"
                     style="text-align: right"
                     data-thread-key="2016/11/26/essay4/"
                     data-title="é•œå¤´ç‚«å…‰ä¸å…‰æ™•"
                     data-url="http://www.weymire.com/2016/11/26/essay4/"
                     data-images="http://www.weymire.com/2016/11/26/essay4/essay4.jpg"
                     data-content=" æœ¬æ–‡åŒæ—¶ä¹Ÿå‘è¡¨åœ¨æˆ‘çš„çŸ¥ä¹ä¸“æ ä¸ŠğŸ˜„. ä¸è¿‡å½“æ—¶å†™ä½œçš„é£æ ¼å®åœ¨ä¸é€‚åˆæŠ€æœ¯æ–‡, å› æ­¤åœ¨ä¸ªäººåšå®¢ä¸­... | Weymire&#39;s Blog ">
                    <div class="ds-share-inline">
                        <ul class="ds-share-icons-16">
                            <li data-toggle="ds-share-icons-more"><a class="ds-more" href="#">åˆ†äº«åˆ°ï¼š</a></li>
                            <li><a class="ds-wechat flat" href="javascript:void(0);" data-service="wechat">å¾®ä¿¡</a></li>
                            <li><a class="ds-weibo flat" href="javascript:void(0);" data-service="weibo">å¾®åš</a></li>
                            <li><a class="ds-douban flat" href="javascript:void(0);" data-service="douban">è±†ç“£</a></li>
                        </ul>
                        <div class="ds-share-icons-more">
                        </div>
                    </div>
                    <hr>
                </div>
                <!-- å¤šè¯´ Share end-->
                

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2016/11/27/essay3/" data-toggle="tooltip" data-placement="top"
                           title="ç›¸äº¤é«˜äº®(æ‰«ææ•ˆæœ)">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2016/03/02/MagicFrame/" data-toggle="tooltip" data-placement="top"
                           title="Magic Frame (é­”æ‹)">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                
                <!-- å¤šè¯´è¯„è®ºæ¡† start -->
                <div class="comment">
                    <div class="ds-thread"
                         data-thread-key="2016/11/26/essay4/"
                         data-title="é•œå¤´ç‚«å…‰ä¸å…‰æ™•"
                         data-url="http://www.weymire.com/2016/11/26/essay4/">
                    </div>
                </div>
                <!-- å¤šè¯´è¯„è®ºæ¡† end -->
                

                

            </div>

            <div class="hidden-xs col-sm-3 toc-col">
                <div class="toc-wrap">
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">é•œå¤´å…‰æ™•å’Œç‚«å…‰æ˜¯ä»€ä¹ˆ?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">å®ç°çš„åŸºæœ¬æ€è·¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">ç‰¹æ•ˆçš„åŸºæœ¬æµç¨‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">Step 1: é™é‡‡æ ·å’Œåƒç´ æå–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">Step 2: è®¡ç®—é¬¼å½±</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">Step 3: æ¨¡ç³Š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">Step 4: ä¸ColorBufferæ··åˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">ä½†æ˜¯, æˆ‘ä»¬ä¸å¸Œæœ›å®ƒçœ‹èµ·æ¥å¥‡æ€ª</span></a></li></ol>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- Sidebar Container -->

            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5 class="text-center">
                        <a href="/tags/">FEATURED TAGS</a>
                    </h5>
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#Unity"
                           title="Unity">Unity</a>
                        
                        <a class="tag" href="/tags/#Computer Graphics"
                           title="Computer Graphics">Computer Graphics</a>
                        
                        <a class="tag" href="/tags/#Shader"
                           title="Shader">Shader</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
            </div>
        </div>

    </div>
</article>


<!-- å¤šè¯´å…¬å…±JSä»£ç  start (ä¸€ä¸ªç½‘é¡µåªéœ€æ’å…¥ä¸€æ¬¡) -->
<script type="text/javascript">
    // dynamic User by Hux
    var _user = 'yujingping';

    // duoshuo comment query.
    var duoshuoQuery = {short_name: _user};
    (function () {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';
        ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
</script>
<!-- å¤šè¯´å…¬å…±JSä»£ç  end -->





<!-- Footer -->
<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                <br>
                <ul class="list-inline text-center">
                
                
                    <li>
                        <a target="_blank" href="https://twitter.com/ehazon">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                
                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/yu-jing-ping-64">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">çŸ¥</i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="http://weibo.com/haojen">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/AlphaMistral">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Weymire 2017
                    <br>
                    <span id="busuanzi_container_site_pv" style="font-size: 12px;">PV: <span id="busuanzi_value_site_pv"></span> Times</span>
                </p>

            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/blog.js"></script>

<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("http://www.weymire.com/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>

<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-91741512-1';
    var _gaDomain = 'auto';
    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>


<!-- Baidu Tongji -->

<script>
    var _baId = 'a7bea2767d4659bf7b7a4f62100a2a13';
    // Originial
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?" + _baId;
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


<!-- swiftype -->
<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','null','2.0.0');
</script>

<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<!--wechat title img-->
<img class="wechat-title-img" src="image/avatar.jpg"><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>

</html>
